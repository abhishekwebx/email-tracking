{"version":3,"sources":["../../../../../../../Desktop/email-traking%20sainty/email-tracking-next/app/crm/admin/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\n\ninterface User {\n  _id: string;\n  name: string;\n  email: string;\n  role: string;\n}\n\ninterface Email {\n  _id: string;\n  to: string;\n  subject: string;\n  senderName: string;\n}\n\nexport default function AdminDashboard() {\n  const router = useRouter();\n  const [users, setUsers] = useState<User[]>([]);\n  const [emails, setEmails] = useState<Email[]>([]);\n  const [loading, setLoading] = useState(true);\n  const user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n  useEffect(() => {\n    if (user.role !== \"admin\") {\n      router.push(\"/crm/dashboard\");\n    }\n\n    const fetchData = async () => {\n      try {\n        const usersRes = await fetch(\"/api/admin/users\", {\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n        });\n        const emailsRes = await fetch(\"/api/admin/emails\", {\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n        });\n        setUsers(await usersRes.json());\n        setEmails(await emailsRes.json());\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  if (loading) return <p>Loading admin data...</p>;\n\n  return (\n    <div className=\"p-6 max-w-7xl mx-auto space-y-8\">\n      <h1 className=\"text-3xl font-bold\">Admin Dashboard</h1>\n\n      {/* USERS */}\n      <section>\n        <h2 className=\"text-2xl font-semibold mb-2\">Users</h2>\n        <table className=\"w-full border-collapse\">\n          <thead>\n            <tr className=\"bg-gray-200\">\n              <th className=\"p-2 border\">Name</th>\n              <th className=\"p-2 border\">Email</th>\n              <th className=\"p-2 border\">Role</th>\n              <th className=\"p-2 border\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {users.map((u) => (\n              <tr key={u._id} className=\"hover:bg-gray-100\">\n                <td className=\"p-2 border\">{u.name}</td>\n                <td className=\"p-2 border\">{u.email}</td>\n                <td className=\"p-2 border\">{u.role}</td>\n                <td className=\"p-2 border space-x-2\">\n                  <button\n                    className=\"px-3 py-1 bg-yellow-500 text-white rounded\"\n                    onClick={() =>\n                      router.push(`/crm/admin/users/edit/${u._id}`)\n                    }\n                  >\n                    Edit\n                  </button>\n                  <button\n                    className=\"px-3 py-1 bg-red-600 text-white rounded\"\n                    onClick={async () => {\n                      if (!confirm(\"Delete this user?\")) return;\n                      await fetch(`/api/admin/users/${u._id}`, {\n                        method: \"DELETE\",\n                        headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n                      });\n                      setUsers(users.filter((usr) => usr._id !== u._id));\n                    }}\n                  >\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </section>\n\n      {/* EMAILS */}\n      <section>\n        <h2 className=\"text-2xl font-semibold mb-2\">Emails</h2>\n        <table className=\"w-full border-collapse\">\n          <thead>\n            <tr className=\"bg-gray-200\">\n              <th className=\"p-2 border\">To</th>\n              <th className=\"p-2 border\">Subject</th>\n              <th className=\"p-2 border\">Sender</th>\n              <th className=\"p-2 border\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {emails.map((e) => (\n              <tr key={e._id} className=\"hover:bg-gray-100\">\n                <td className=\"p-2 border\">{e.to}</td>\n                <td className=\"p-2 border\">{e.subject}</td>\n                <td className=\"p-2 border\">{e.senderName}</td>\n                <td className=\"p-2 border space-x-2\">\n                  <button\n                    className=\"px-3 py-1 bg-yellow-500 text-white rounded\"\n                    onClick={() => router.push(`/send/${e._id}`)}\n                  >\n                    Edit\n                  </button>\n                  <button\n                    className=\"px-3 py-1 bg-red-600 text-white rounded\"\n                    onClick={async () => {\n                      if (!confirm(\"Delete this email?\")) return;\n                      await fetch(`/api/admin/emails/${e._id}`, {\n                        method: \"DELETE\",\n                      });\n                      setEmails(emails.filter((em) => em._id !== e._id));\n                    }}\n                  >\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}