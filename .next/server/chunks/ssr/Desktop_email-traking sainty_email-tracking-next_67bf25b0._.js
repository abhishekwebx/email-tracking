module.exports=[55554,(a,b,c)=>{"use strict";b.exports=a.r(55470).vendored["react-ssr"].ReactDOM},46528,a=>{"use strict";var b=a.i(21695),c=a.i(18599),d=a.i(70282),e=a.i(51835),f=a.i(86123);function g({emailId:a}){let g,h=(0,e.useRouter)(),i=(0,e.useSearchParams)().get("template"),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(a||null),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/templates?limit=50"),b=await a.json();C(Array.isArray(b.data)?b.data:[])}catch(a){console.error("Template load error",a)}})()},[]),(0,c.useEffect)(()=>{if(!i||!Array.isArray(B))return;let a=B.find(a=>a._id===i);a&&(E(a._id),o(a.subject||""),q(a.body||""))},[i,B]),(0,c.useEffect)(()=>{let a=JSON.parse(localStorage.getItem("user")||"{}");s(a?.email||"")},[]),(0,c.useEffect)(()=>{a&&(async()=>{try{let b=await fetch(`/api/emails/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),c=await b.json();if(!b.ok)throw Error(c.error);k(c.to||[]),o(c.subject||""),q(c.body||""),s(c.senderName||""),A(c._id)}catch(a){console.error("Draft load error",a)}})()},[a]);let F=()=>j.length>0&&""!==n.trim()&&""!==p.trim(),G=async()=>{u(!0),w(null);try{let a=await fetch("/api/draft",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({id:z,senderName:r,to:j,subject:n,body:p})}),b=await a.json();if(!a.ok)throw Error(b.error);A(b._id),h.push("/crm/draft-mail")}catch(a){w(a.message||"Failed to save draft")}finally{u(!1)}},H=async()=>{if(!F())return void w("All fields are required");u(!0),w(null);try{let a=await fetch("/api/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({id:z,to:j,subject:n,body:p,senderName:r})}),b=await a.json();if(!a.ok)throw Error(b.error);y(!0),k([]),o(""),q(""),A(null)}catch(a){w(a.message||"Failed to send email")}finally{u(!1)}};return(0,b.jsx)(d.default,{children:(0,b.jsx)("div",{className:"container",children:(0,b.jsxs)("div",{className:"card",children:[(0,b.jsx)("h1",{children:"Send Email"}),(0,b.jsx)("p",{className:"subtitle",children:"Track opens in real-time"}),v&&(0,b.jsx)("div",{className:"error",children:v}),x&&(0,b.jsx)("div",{className:"success",children:"Email sent successfully!"}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-semibold mb-2",children:"Select Template"}),(0,b.jsxs)("select",{value:D,onChange:a=>{var b;let c;return E(b=a.target.value),void((c=B.find(a=>a._id===b))&&(o(c.subject||""),q(c.body||"")))},className:"w-full border rounded-xl px-4 py-3",children:[(0,b.jsx)("option",{value:"",children:"Choose Template"}),Array.isArray(B)&&B.map(a=>(0,b.jsxs)("option",{value:a._id,children:[a.title,a.category?` (${a.category})`:""]},a._id))]}),D&&(0,b.jsx)("div",{className:"mt-4 border rounded-xl p-4 bg-indigo-50",children:(g=B.find(a=>a._id===D))?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h3",{className:"font-semibold text-indigo-700",children:g.title}),(0,b.jsx)("p",{className:"text-sm mt-2",children:g.subject})]}):null})]}),(0,b.jsx)("label",{children:"To"}),(0,b.jsxs)("div",{className:"email-wrapper",children:[j.map(a=>(0,b.jsxs)("span",{className:"chip",children:[a,(0,b.jsx)("button",{onClick:()=>{k(j.filter(b=>b!==a))},children:"Ã—"})]},a)),(0,b.jsx)("input",{type:"email",placeholder:"Type email & press Enter",value:l,onChange:a=>m(a.target.value),onKeyDown:a=>{if("Enter"===a.key&&l.trim()){var b;let c;a.preventDefault(),(c=b=(b=l).trim(),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c))?(j.includes(b)||k([b,...j]),m(""),w(null)):w("Invalid email format")}},onPaste:a=>{a.clipboardData.getData("text").split(/[,;\s]+/).forEach(a=>{/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)&&!j.includes(a)&&k(b=>[a,...b])}),a.preventDefault()}})]}),(0,b.jsx)("label",{children:"Subject"}),(0,b.jsx)("input",{value:n,onChange:a=>o(a.target.value)}),(0,b.jsx)("label",{children:"Message"}),(0,b.jsx)(f.default,{body:p,setBody:q}),(0,b.jsx)("button",{className:"send-button ml-2",onClick:G,disabled:t,children:t?"Saving...":"Save Email as Draft"}),(0,b.jsx)("button",{className:"send-button",onClick:H,disabled:!F(),children:t?"Sending...":"Send Email"})]})})})}a.s(["default",()=>g])},9659,a=>{"use strict";let b=(0,a.i(43695).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],9659)},22122,59973,a=>{"use strict";var b=a.i(21695),c=a.i(96810);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>e],22122);let f=(0,a.i(43695).default)("mouse-pointer-click",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);a.s(["MousePointerClick",()=>f],59973)},88124,a=>{"use strict";var b=a.i(21695),c=a.i(18599),d=a.i(51835),e=a.i(70282),f=a.i(22122),g=a.i(9659),h=a.i(59973);let i=(0,a.i(43695).default)("mail-check",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);function j(){let{id:a}=(0,d.useParams)(),[j,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(!0);return((0,c.useEffect)(()=>{let b=async()=>{let b=await fetch(`/api/emails/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});m(await b.json()),o(!1)};a&&b()},[a]),n)?(0,b.jsx)("div",{className:"flex h-[60vh] items-center justify-center text-xl font-semibold text-muted-foreground",children:"Loading Email..."}):j?(0,b.jsx)(e.default,{children:(0,b.jsxs)("main",{className:"p-6 md:p-10 max-w-6xl mx-auto space-y-8",children:[(0,b.jsxs)("header",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Email Details"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Complete activity and message preview"})]}),(0,b.jsxs)("section",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsx)(l,{title:"Open Count",value:j.openCount,icon:(0,b.jsx)(g.Eye,{}),gradient:"from-green-500 to-emerald-500"}),(0,b.jsx)(l,{title:"Click Count",value:j.clickCount,icon:(0,b.jsx)(h.MousePointerClick,{}),gradient:"from-pink-500 to-rose-500"}),(0,b.jsx)(l,{title:"Delivery",value:"Sent",icon:(0,b.jsx)(i,{}),gradient:"from-blue-500 to-indigo-500"})]}),(0,b.jsx)(f.Card,{className:"rounded-2xl shadow-sm",children:(0,b.jsx)(f.CardContent,{className:"p-6 space-y-3",children:(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[(0,b.jsx)(k,{label:"Recipient",value:j.to}),(0,b.jsx)(k,{label:"Subject",value:j.subject}),(0,b.jsx)(k,{label:"Sent At",value:new Date(j.sentAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Status"}),(0,b.jsx)("span",{className:`inline-block mt-1 px-3 py-1 rounded-full text-xs font-semibold ${j.opened?"bg-green-100 text-green-700":"bg-gray-200 text-gray-600"}`,children:j.opened?"Opened":"Pending"})]})]})})}),(0,b.jsx)(f.Card,{className:"rounded-2xl shadow-sm",children:(0,b.jsxs)(f.CardContent,{className:"p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Email Preview"}),(0,b.jsx)("div",{className:"border rounded-xl p-5 bg-muted/30 prose max-w-none",children:(0,b.jsx)("div",{className:"email-body",dangerouslySetInnerHTML:{__html:j.body}})})]})})]})}):(0,b.jsx)("p",{children:"Email not found"})}function k({label:a,value:c}){return(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground text-xs",style:{marginBottom:"5px"},children:a}),(0,b.jsx)("p",{className:"font-medium",children:c})]})}function l({title:a,value:c,icon:d,gradient:e}){return(0,b.jsx)(f.Card,{className:"rounded-2xl shadow-sm hover:shadow-md transition",children:(0,b.jsxs)(f.CardContent,{className:"p-6 flex items-center gap-4",children:[(0,b.jsx)("div",{className:`p-3 rounded-xl text-white bg-gradient-to-br ${e}`,children:d}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:c})]})]})})}a.s(["default",()=>j],88124)},40042,a=>{"use strict";var b=a.i(21695),c=a.i(70282),d=a.i(51835),e=a.i(46528),f=a.i(88124);function g(){let a=(0,d.useParams)(),g=sessionStorage.getItem("route");return(0,b.jsxs)(c.default,{children:["/crm/dashboard"!==g&&(0,b.jsx)(e.default,{emailId:a?.id}),"/crm/dashboard"===g&&(0,b.jsx)(f.default,{})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=Desktop_email-traking%20sainty_email-tracking-next_67bf25b0._.js.map