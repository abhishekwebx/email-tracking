{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/hp/Desktop/email-traking%20sainty/email-tracking-next/components/EmailBuilder.tsx"],"sourcesContent":["\"use client\";\n\nimport { LexicalComposer } from \"@lexical/react/LexicalComposer\";\nimport { RichTextPlugin } from \"@lexical/react/LexicalRichTextPlugin\";\nimport { ContentEditable } from \"@lexical/react/LexicalContentEditable\";\nimport { HistoryPlugin } from \"@lexical/react/LexicalHistoryPlugin\";\nimport { OnChangePlugin } from \"@lexical/react/LexicalOnChangePlugin\";\nimport { $generateHtmlFromNodes } from \"@lexical/html\";\n\ninterface Props {\n  value: string;\n  onChange: (html: string) => void;\n}\n\nexport default function EmailBuilder({ value, onChange }: Props) {\n\n  const initialConfig = {\n    namespace: \"EmailEditor\",\n    onError(error: Error) {\n      console.error(error);\n    }\n  };\n\n  return (\n    <div className=\"border rounded-xl p-3 bg-white\">\n      <LexicalComposer initialConfig={initialConfig}>\n        \n        <RichTextPlugin\n          contentEditable={\n            <ContentEditable className=\"min-h-[200px] outline-none\" />\n          }\n          placeholder={<div className=\"text-gray-400\">Type email content...</div>}\n        />\n\n        <HistoryPlugin />\n\n        <OnChangePlugin\n          onChange={(editorState, editor) => {\n            editorState.read(() => {\n              const html = $generateHtmlFromNodes(editor, null);\n              onChange(html);\n            });\n          }}\n        />\n\n      </LexicalComposer>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AAce,SAAS,aAAa,EAAE,KAAK,EAAE,QAAQ,EAAS;IAE7D,MAAM,gBAAgB;QACpB,WAAW;QACX,SAAQ,KAAY;YAClB,QAAQ,KAAK,CAAC;QAChB;IACF;IAEA,qBACE,kTAAC;QAAI,WAAU;kBACb,cAAA,kTAAC,oPAAe;YAAC,eAAe;;8BAE9B,kTAAC,yPAAc;oBACb,+BACE,kTAAC,2PAAe;wBAAC,WAAU;;;;;;oBAE7B,2BAAa,kTAAC;wBAAI,WAAU;kCAAgB;;;;;;;;;;;8BAG9C,kTAAC,uQAAa;;;;;8BAEd,kTAAC,yPAAc;oBACb,UAAU,CAAC,aAAa;wBACtB,YAAY,IAAI,CAAC;4BACf,MAAM,OAAO,IAAA,sPAAsB,EAAC,QAAQ;4BAC5C,SAAS;wBACX;oBACF;;;;;;;;;;;;;;;;;AAMV"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///home/hp/Desktop/email-traking%20sainty/email-tracking-next/app/send/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport \"./send-email.css\";\nimport EmailBuilder from \"@/components/EmailBuilder\";\n\ninterface EmailData {\n  id: string;\n  to: string;\n  subject: string;\n  body: string;\n  senderName: string;\n}\n\ninterface SendEmailProps {\n  emailId?: string;\n}\n\nexport default function SendEmail({ emailId }: SendEmailProps) {\n  const router = useRouter();\n\n  const [to, setTo] = useState(\"\");\n  const [subject, setSubject] = useState(\"\");\n  const [body, setBody] = useState(\"\");\n  const [senderName, setSenderName] = useState(\"\");\n\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  // Load user safely\n  useEffect(() => {\n    const user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n    setSenderName(user?.email || \"\");\n  }, []);\n\n  // Load existing email if editing\n  useEffect(() => {\n    if (!emailId) return;\n\n    const fetchEmail = async () => {\n      setLoading(true);\n      try {\n        const res = await fetch(`/api/emails/${emailId}`, {\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n        });\n        const data: EmailData = await res.json();\n        if (!res.ok) throw new Error(data?.toString() || \"Failed to load email\");\n\n        setTo(data.to);\n        setSubject(data.subject);\n        setBody(data.body);\n      } catch (err) {\n        // setError(err.message || \"Failed to fetch email\");\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchEmail();\n  }, [emailId]);\n\n  const sendOrUpdate = async () => {\n    setError(null);\n    setSuccess(false);\n\n    if (!to || !subject || !body) {\n      setError(\"All fields are required\");\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const res = await fetch(emailId ? `/api/emails/${emailId}` : \"/api/send\", {\n        method: emailId ? \"PUT\" : \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n        body: JSON.stringify({ to, subject, body, senderName }),\n      });\n\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error || \"Failed to send/update email\");\n\n      setSuccess(true);\n\n      if (!emailId) {\n        setTo(\"\");\n        setSubject(\"\");\n        setBody(\"\");\n      }\n    } catch (err) {\n      // setError(err.message || \"Something went wrong\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"card\">\n        <button className=\"back-button\" onClick={() => router.push(\"/dashboard\")}>\n          ← Back\n        </button>\n\n        <h1>{emailId ? \"Edit Email\" : \"Send Email\"}</h1>\n        <p className=\"subtitle\">Track opens in real-time</p>\n\n        {error && <div className=\"error\">{error}</div>}\n        {success && (\n          <div className=\"success\">\n            {emailId ? \"Email updated successfully!\" : \"Email sent successfully!\"}\n          </div>\n        )}\n\n        <label>To</label>\n        <input\n          type=\"email\"\n          placeholder=\"user@example.com\"\n          value={to}\n          onChange={(e) => setTo(e.target.value)}\n        />\n\n        <label>Subject</label>\n        <input\n          placeholder=\"Email subject\"\n          value={subject}\n          onChange={(e) => setSubject(e.target.value)}\n        />\n\n        <label>Message</label>\n        <EmailBuilder value={body} onChange={setBody} />\n\n        <button className=\"send-button\" disabled={loading} onClick={sendOrUpdate}>\n          {loading ? (emailId ? \"Updating…\" : \"Sending…\") : emailId ? \"Update Email\" : \"Send Email\"}\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}