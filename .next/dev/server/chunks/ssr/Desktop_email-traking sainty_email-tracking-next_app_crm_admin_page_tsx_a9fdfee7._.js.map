{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hp/Desktop/email-traking%20sainty/email-tracking-next/app/crm/admin/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\n\ninterface User {\n  _id: string;\n  name: string;\n  email: string;\n  role: string;\n}\n\ninterface Email {\n  _id: string;\n  to: string;\n  subject: string;\n  senderName: string;\n}\n\nexport default function AdminDashboard() {\n  const router = useRouter();\n  const [users, setUsers] = useState<User[]>([]);\n  const [emails, setEmails] = useState<Email[]>([]);\n  const [loading, setLoading] = useState(true);\n  const user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n  useEffect(() => {\n    if (user.role !== \"admin\") {\n      router.push(\"/crm/dashboard\");\n    }\n\n    const fetchData = async () => {\n      try {\n        const usersRes = await fetch(\"/api/admin/users\", {\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n        });\n        const emailsRes = await fetch(\"/api/admin/emails\", {\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n        });\n        setUsers(await usersRes.json());\n        setEmails(await emailsRes.json());\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  if (loading) return <p>Loading admin data...</p>;\n\n  return (\n    <div className=\"p-6 max-w-7xl mx-auto space-y-8\">\n      <h1 className=\"text-3xl font-bold\">Admin Dashboard</h1>\n\n      {/* USERS */}\n      <section>\n        <h2 className=\"text-2xl font-semibold mb-2\">Users</h2>\n        <table className=\"w-full border-collapse\">\n          <thead>\n            <tr className=\"bg-gray-200\">\n              <th className=\"p-2 border\">Name</th>\n              <th className=\"p-2 border\">Email</th>\n              <th className=\"p-2 border\">Role</th>\n              <th className=\"p-2 border\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {users.map((u) => (\n              <tr key={u._id} className=\"hover:bg-gray-100\">\n                <td className=\"p-2 border\">{u.name}</td>\n                <td className=\"p-2 border\">{u.email}</td>\n                <td className=\"p-2 border\">{u.role}</td>\n                <td className=\"p-2 border space-x-2\">\n                  <button\n                    className=\"px-3 py-1 bg-yellow-500 text-white rounded\"\n                    onClick={() =>\n                      router.push(`/crm/admin/users/edit/${u._id}`)\n                    }\n                  >\n                    Edit\n                  </button>\n                  <button\n                    className=\"px-3 py-1 bg-red-600 text-white rounded\"\n                    onClick={async () => {\n                      if (!confirm(\"Delete this user?\")) return;\n                      await fetch(`/api/admin/users/${u._id}`, {\n                        method: \"DELETE\",\n                        headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n                      });\n                      setUsers(users.filter((usr) => usr._id !== u._id));\n                    }}\n                  >\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </section>\n\n      {/* EMAILS */}\n      <section>\n        <h2 className=\"text-2xl font-semibold mb-2\">Emails</h2>\n        <table className=\"w-full border-collapse\">\n          <thead>\n            <tr className=\"bg-gray-200\">\n              <th className=\"p-2 border\">To</th>\n              <th className=\"p-2 border\">Subject</th>\n              <th className=\"p-2 border\">Sender</th>\n              <th className=\"p-2 border\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {emails.map((e) => (\n              <tr key={e._id} className=\"hover:bg-gray-100\">\n                <td className=\"p-2 border\">{e.to}</td>\n                <td className=\"p-2 border\">{e.subject}</td>\n                <td className=\"p-2 border\">{e.senderName}</td>\n                <td className=\"p-2 border space-x-2\">\n                  <button\n                    className=\"px-3 py-1 bg-yellow-500 text-white rounded\"\n                    onClick={() => router.push(`/send/${e._id}`)}\n                  >\n                    Edit\n                  </button>\n                  <button\n                    className=\"px-3 py-1 bg-red-600 text-white rounded\"\n                    onClick={async () => {\n                      if (!confirm(\"Delete this email?\")) return;\n                      await fetch(`/api/admin/emails/${e._id}`, {\n                        method: \"DELETE\",\n                      });\n                      setEmails(emails.filter((em) => em._id !== e._id));\n                    }}\n                  >\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}