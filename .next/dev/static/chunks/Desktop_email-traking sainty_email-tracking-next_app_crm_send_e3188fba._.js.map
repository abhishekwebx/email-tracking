{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hp/Desktop/email-traking%20sainty/email-tracking-next/app/crm/send/emailEditor.tsx"],"sourcesContent":["/* eslint-disable react-hooks/static-components */\n\"use client\";\n\nimport { useEditor, EditorContent } from \"@tiptap/react\";\nimport StarterKit from \"@tiptap/starter-kit\";\nimport Underline from \"@tiptap/extension-underline\";\nimport Link from \"@tiptap/extension-link\";\nimport Image from \"@tiptap/extension-image\";\nimport TextAlign from \"@tiptap/extension-text-align\";\nimport \"./editor.css\";\n\nimport {\n  Bold,\n  Italic,\n  Underline as UnderlineIcon,\n  List,\n  ListOrdered,\n  LinkIcon,\n  ImageIcon,\n  Undo,\n  Redo,\n  AlignLeft,\n  AlignCenter,\n  AlignRight,\n  Upload,\n} from \"lucide-react\";\n\nimport { useEffect, useRef, useState } from \"react\";\n\ninterface Props {\n  body: string;\n  setBody: (html: string) => void;\n}\n\nexport default function SimpleEmailEditor({ body, setBody }: Props) {\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [showImageInput, setShowImageInput] = useState(false);\n\n  const fileRef = useRef<HTMLInputElement>(null);\n\n  // ⭐ Editor Setup\n  const editor = useEditor({\n    extensions: [\n      StarterKit.configure({\n        heading: {\n          levels: [1, 2, 3, 4, 5, 6],\n        },\n        bulletList: {\n          keepMarks: true,\n        },\n        orderedList: {\n          keepMarks: true,\n        },\n      }),\n\n      Underline,\n\n      Link.configure({\n        openOnClick: false,\n        autolink: true,\n      }),\n\n      Image.configure({\n        inline: false,\n        allowBase64: true,\n      }),\n\n      TextAlign.configure({\n        types: [\"heading\", \"paragraph\"],\n      }),\n    ],\n\n    content: body || \"<p>Start writing your email...</p>\",\n\n    immediatelyRender: false,\n\n    onUpdate({  }) {\n      setBody(editor.getHTML());\n    },\n  });\n\n  // ⭐ Sync external body\n  useEffect(() => {\n    if (!editor) return;\n    if (body !== editor.getHTML()) {\n      editor.commands.setContent(body);\n    }\n  }, [body, editor]);\n\n  if (!editor) return null;\n\n  // ⭐ Upload Image\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n\n    reader.onload = () => {\n      editor.chain().focus().setImage({ src: reader.result as string }).run();\n    };\n\n    reader.readAsDataURL(file);\n  };\n\n  // ⭐ Toolbar Button\n  const Btn = ({\n    onClick,\n    active,\n    children,\n  }: {\n    onClick: () => void;\n    active?: boolean;\n    children: React.ReactNode;\n  }) => (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      className={`p-2 rounded transition ${\n        active ? \"bg-blue-200\" : \"hover:bg-gray-200\"\n      }`}\n    >\n      {children}\n    </button>\n  );\n\n  return (\n    <div className=\"border rounded-xl shadow-sm bg-white\">\n\n      {/* ⭐ TOOLBAR */}\n      <div className=\"flex flex-wrap items-center gap-2 border-b p-2 bg-gray-50\">\n\n        {/* Heading Dropdown */}\n        <select\n          className=\"border rounded p-1\"\n          onChange={(e) => {\n            const level = Number(e.target.value);\n\n            if (level === 0) {\n              editor.chain().focus().setParagraph().run();\n            } else {\n              editor.chain().focus().toggleHeading({ level }).run();\n            }\n          }}\n        >\n          <option value=\"0\">Paragraph</option>\n          <option value=\"1\">H1</option>\n          <option value=\"2\">H2</option>\n          <option value=\"3\">H3</option>\n          <option value=\"4\">H4</option>\n          <option value=\"5\">H5</option>\n          <option value=\"6\">H6</option>\n        </select>\n\n        <Btn\n          onClick={() => editor.chain().focus().toggleBold().run()}\n          active={editor.isActive(\"bold\")}\n        >\n          <Bold size={18} />\n        </Btn>\n\n        <Btn\n          onClick={() => editor.chain().focus().toggleItalic().run()}\n          active={editor.isActive(\"italic\")}\n        >\n          <Italic size={18} />\n        </Btn>\n\n        <Btn\n          onClick={() => editor.chain().focus().toggleUnderline().run()}\n          active={editor.isActive(\"underline\")}\n        >\n          <UnderlineIcon size={18} />\n        </Btn>\n\n        <Btn\n          onClick={() => editor.chain().focus().toggleBulletList().run()}\n          active={editor.isActive(\"bulletList\")}\n        >\n          <List size={18} />\n        </Btn>\n\n        <Btn\n          onClick={() => editor.chain().focus().toggleOrderedList().run()}\n          active={editor.isActive(\"orderedList\")}\n        >\n          <ListOrdered size={18} />\n        </Btn>\n\n        {/* Link */}\n        {/* <Btn\n          onClick={() => {\n            const url = prompt(\"Enter URL\");\n            if (!url) return;\n            editor.chain().focus().setLink({ href: url }).run();\n          }}\n        >\n          <LinkIcon size={18} />\n        </Btn> */}\n\n        {/* Image URL */}\n        <Btn onClick={() => setShowImageInput(!showImageInput)}>\n          <ImageIcon size={18} />\n        </Btn>\n\n        {/* Upload Image */}\n        <Btn onClick={() => fileRef.current?.click()}>\n          <Upload size={18} />\n        </Btn>\n\n        <Btn onClick={() => editor.chain().focus().setTextAlign(\"left\").run()}>\n          <AlignLeft size={18} />\n        </Btn>\n\n        <Btn\n          onClick={() => editor.chain().focus().setTextAlign(\"center\").run()}\n        >\n          <AlignCenter size={18} />\n        </Btn>\n\n        <Btn\n          onClick={() => editor.chain().focus().setTextAlign(\"right\").run()}\n        >\n          <AlignRight size={18} />\n        </Btn>\n\n        <Btn onClick={() => editor.chain().focus().undo().run()}>\n          <Undo size={18} />\n        </Btn>\n\n        <Btn onClick={() => editor.chain().focus().redo().run()}>\n          <Redo size={18} />\n        </Btn>\n      </div>\n\n      {/* ⭐ IMAGE URL INPUT */}\n      {showImageInput && (\n        <div className=\"flex gap-2 p-2 border-b bg-gray-100\">\n          <input\n            className=\"border p-2 flex-1 rounded\"\n            placeholder=\"Paste image URL...\"\n            value={imageUrl}\n            onChange={(e) => setImageUrl(e.target.value)}\n          />\n\n          <button\n            className=\"bg-blue-500 text-white px-4 rounded\"\n            onClick={() => {\n              if (!imageUrl) return;\n\n              editor.chain().focus().setImage({ src: imageUrl }).run();\n              setImageUrl(\"\");\n              setShowImageInput(false);\n            }}\n          >\n            Insert\n          </button>\n        </div>\n      )}\n\n      {/* Hidden Upload */}\n      <input\n        type=\"file\"\n        accept=\"image/*\"\n        ref={fileRef}\n        hidden\n        onChange={handleImageUpload}\n      />\n\n      {/* ⭐ EDITOR */}\n      <EditorContent\n        editor={editor}\n        className=\"ProseMirror min-h-[350px] p-4 focus:outline-none\"\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 460, "column": 0}, "map": {"version":3,"sources":["file:///home/hp/Desktop/email-traking%20sainty/email-tracking-next/app/crm/send/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport \"./send-email.css\";\nimport AuthGuard from \"@/components/AuthGuard\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport SimpleEmailEditor from \"./emailEditor\";\n\ninterface SendEmailProps {\n  emailId?: string;\n}\n\nexport default function SendEmail({ emailId }: SendEmailProps) {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n\n  const templateFromUrl = searchParams.get(\"template\");\n\n  const [to, setTo] = useState<string[]>([]);\n  const [inputValue, setInputValue] = useState(\"\");\n\n  const [subject, setSubject] = useState(\"\");\n  const [body, setBody] = useState(\"\");\n  const [senderName, setSenderName] = useState(\"\");\n\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  const [draftId, setDraftId] = useState<string | null>(emailId || null);\n  const [templates, setTemplates] = useState<any[]>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState(\"\");\n\n  /* ---------------------------------------------------\n     LOAD TEMPLATES\n  --------------------------------------------------- */\n\n  useEffect(() => {\n    const loadTemplates = async () => {\n      try {\n        const res = await fetch(\"/api/templates?limit=50\");\n        const data = await res.json();\n\n        setTemplates(Array.isArray(data.data) ? data.data : []);\n      } catch (err) {\n        console.error(\"Template load error\", err);\n      }\n    };\n\n    loadTemplates();\n  }, []);\n\n  /* ---------------------------------------------------\n     AUTO LOAD TEMPLATE FROM URL\n  --------------------------------------------------- */\n\n  useEffect(() => {\n    if (!templateFromUrl) return;\n    if (!Array.isArray(templates)) return;\n\n    const template = templates.find(\n      (t) => t._id === templateFromUrl\n    );\n\n    if (template) {\n      setSelectedTemplate(template._id);\n      setSubject(template.subject || \"\");\n      setBody(template.body || \"\");\n    }\n  }, [templateFromUrl, templates]);\n\n  /* ---------------------------------------------------\n     TEMPLATE SELECT HANDLER\n  --------------------------------------------------- */\n\n  const handleTemplateSelect = (templateId: string) => {\n    setSelectedTemplate(templateId);\n\n    const template = templates.find((t) => t._id === templateId);\n\n    if (template) {\n      setSubject(template.subject || \"\");\n      setBody(template.body || \"\");\n    }\n  };\n\n  /* ---------------------------------------------------\n     LOAD USER\n  --------------------------------------------------- */\n\n  useEffect(() => {\n    const user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n    setSenderName(user?.email || \"\");\n  }, []);\n\n  /* ---------------------------------------------------\n     LOAD DRAFT\n  --------------------------------------------------- */\n\n  useEffect(() => {\n    if (!emailId) return;\n\n    const loadDraft = async () => {\n      try {\n        const res = await fetch(`/api/emails/${emailId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          },\n        });\n\n        const data = await res.json();\n        if (!res.ok) throw new Error(data.error);\n\n        setTo(data.to || []);\n        setSubject(data.subject || \"\");\n        setBody(data.body || \"\");\n        setSenderName(data.senderName || \"\");\n        setDraftId(data._id);\n      } catch (err) {\n        console.error(\"Draft load error\", err);\n      }\n    };\n\n    loadDraft();\n  }, [emailId]);\n\n  /* ---------------------------------------------------\n     EMAIL HANDLING\n  --------------------------------------------------- */\n\n  const isValidEmail = (email: string) =>\n    /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n\n  const addEmail = (email: string) => {\n    email = email.trim();\n\n    if (!isValidEmail(email)) {\n      setError(\"Invalid email format\");\n      return;\n    }\n\n    if (!to.includes(email)) {\n      setTo([email, ...to]);\n    }\n\n    setInputValue(\"\");\n    setError(null);\n  };\n\n  const removeEmail = (email: string) => {\n    setTo(to.filter((e) => e !== email));\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === \"Enter\" && inputValue.trim()) {\n      e.preventDefault();\n      addEmail(inputValue);\n    }\n  };\n\n  const handlePaste = (e: React.ClipboardEvent<HTMLInputElement>) => {\n    const paste = e.clipboardData.getData(\"text\");\n    const emails = paste.split(/[,;\\s]+/);\n\n    emails.forEach((email) => {\n      if (isValidEmail(email) && !to.includes(email)) {\n        setTo((prev) => [email, ...prev]);\n      }\n    });\n\n    e.preventDefault();\n  };\n\n  const isFormValid = () =>\n    to.length > 0 && subject.trim() !== \"\" && body.trim() !== \"\";\n\n  /* ---------------------------------------------------\n     SAVE DRAFT\n  --------------------------------------------------- */\n\n  const saveAsDraft = async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const res = await fetch(\"/api/draft\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n        body: JSON.stringify({\n          id: draftId,\n          senderName,\n          to,\n          subject,\n          body,\n        }),\n      });\n\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error);\n\n      setDraftId(data._id);\n      router.push(\"/crm/draft-mail\");\n    } catch (err: any) {\n      setError(err.message || \"Failed to save draft\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /* ---------------------------------------------------\n     SEND EMAIL\n  --------------------------------------------------- */\n\n  const sendEmail = async () => {\n    if (!isFormValid()) {\n      setError(\"All fields are required\");\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const res = await fetch(\"/api/send\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n        body: JSON.stringify({\n          id: draftId,\n          to,\n          subject,\n          body,\n          senderName,\n        }),\n      });\n\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error);\n\n      setSuccess(true);\n      setTo([]);\n      setSubject(\"\");\n      setBody(\"\");\n      setDraftId(null);\n    } catch (err: any) {\n      setError(err.message || \"Failed to send email\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /* ---------------------------------------------------\n     UI\n  --------------------------------------------------- */\n\n  return (\n    <AuthGuard>\n      <div className=\"container\">\n        <div className=\"card\">\n          <h1>Send Email</h1>\n          <p className=\"subtitle\">Track opens in real-time</p>\n\n          {error && <div className=\"error\">{error}</div>}\n          {success && (\n            <div className=\"success\">Email sent successfully!</div>\n          )}\n\n          {/* TEMPLATE SELECTOR */}\n          <div className=\"mb-6\">\n            <label className=\"block text-sm font-semibold mb-2\">\n              Select Template\n            </label>\n\n            <select\n              value={selectedTemplate}\n              onChange={(e) => handleTemplateSelect(e.target.value)}\n              className=\"w-full border rounded-xl px-4 py-3\"\n            >\n              <option value=\"\">Choose Template</option>\n\n              {Array.isArray(templates) &&\n                templates.map((template) => (\n                  <option key={template._id} value={template._id}>\n                    {template.title}\n                    {template.category\n                      ? ` (${template.category})`\n                      : \"\"}\n                  </option>\n                ))}\n            </select>\n\n            {/* Template Preview */}\n            {selectedTemplate && (\n              <div className=\"mt-4 border rounded-xl p-4 bg-indigo-50\">\n                {(() => {\n                  const template = templates.find(\n                    (t) => t._id === selectedTemplate\n                  );\n\n                  if (!template) return null;\n\n                  return (\n                    <>\n                      <h3 className=\"font-semibold text-indigo-700\">\n                        {template.title}\n                      </h3>\n                      <p className=\"text-sm mt-2\">\n                        {template.subject}\n                      </p>\n                    </>\n                  );\n                })()}\n              </div>\n            )}\n          </div>\n\n          {/* TO */}\n          <label>To</label>\n          <div className=\"email-wrapper\">\n            {to.map((email) => (\n              <span key={email} className=\"chip\">\n                {email}\n                <button onClick={() => removeEmail(email)}>×</button>\n              </span>\n            ))}\n\n            <input\n              type=\"email\"\n              placeholder=\"Type email & press Enter\"\n              value={inputValue}\n              onChange={(e) => setInputValue(e.target.value)}\n              onKeyDown={handleKeyDown}\n              onPaste={handlePaste}\n            />\n          </div>\n\n          {/* SUBJECT */}\n          <label>Subject</label>\n          <input\n            value={subject}\n            onChange={(e) => setSubject(e.target.value)}\n          />\n\n          {/* MESSAGE */}\n          <label>Message</label>\n          <SimpleEmailEditor body={body} setBody={setBody} />\n\n          {/* BUTTONS */}\n          <button\n            className=\"send-button ml-2\"\n            onClick={saveAsDraft}\n            disabled={loading}\n          >\n            {loading ? \"Saving...\" : \"Save Email as Draft\"}\n          </button>\n\n          <button\n            className=\"send-button\"\n            onClick={sendEmail}\n            disabled={!isFormValid()}\n          >\n            {loading ? \"Sending...\" : \"Send Email\"}\n          </button>\n        </div>\n      </div>\n    </AuthGuard>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}